Je vois un executable qui comme dans l'exercice precedent a des SUID qui permet de l'executer avec les droits de flag07.

Je vais le mettre dans Ghidra pour voir. J'utilise scp comme tout a l'heure...

Dans Ghidra, je vois que le code print la variable d'environnement LOGNAME, j'ai l'impression qu'elle execute aussi quelque chose...

Ok asprintf affiche la commande a executer mais elle l'alloue egalement, cette commande et ensuite executee, je vais essayer de juste mettre getflag en LOGNAME.

Ca m'affiche juste getflag.

Ah non asprintf n'affiche rien, ca alloue une chaine de characteres. C'est juste qu'il y a un "/bin/echo" qui fait que ca va afficher la variable LOGNAME dans l'appel system().

il faut que j'envoi une chaine du style "test && getflag" pour que le bin echo se mette avant et que ca execute le getflag (en affichant test).
BINGO !

j'ai juste mis ca en variable d'environnement et ca a fonctionne :
LOGNAME=test && getflag

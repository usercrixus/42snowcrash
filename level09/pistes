Comme l'exercice precedent un executable et un token, je ne peux pas lire le token et l'executable s'execute avec les droits de flag09.

la difference est que je peux lire le token, mais je ne peux rien en faire.

analyse de l'executable...

le programme semble prendre une chaine de charactere et lui ajouter charactere par charactere 0, +1, +2... en ascii.

Je vais essayer de mettre le token en argument pour voir.

ca me donne cette chaine de charactere : f5mpq;vxwNMP, mais elle ne permet pas grand chose.

analyse du code dans Ghidra...

le fichier se comporte bien comme je le pensais, or en faisant cat token j'ai l'impression qu'il y a des characteres non imprimables que je n'aurais pas copie.

utilisation de cat -v, pour afficher les charactere imprimables sous forme visible.

ca ne donne rien, peut etre que le fichier token a ete crypte par l'executable, je vais essayer de faire un script en C qui decrypte

creation de ce petit programme en C qui decremente les charactere en fonction de leur position (il fait donc l'inverse)

#include <stdio.h>
#include <stdlib.h>

int main(void)
{
	void *file = fopen("token", "r");
	char buf[1024];
	int i = 0;

	fgets(buf, sizeof(buf), file);
	while (buf[i])
	{
		buf[i] = buf[i] - i;
		i++;
	}
	printf("%s", buf);
	fclose(file);
}


Resultat : f3iji1ju5yuevaus41q1afiuq

et ca marche !!!!
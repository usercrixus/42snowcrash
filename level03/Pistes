Fichier a exploiter

ls -l directement pour voir les permissions, le fichier peut s'executer avec les permissions de flag03 (-rws), je cherche dans cette direction...

decouverte avec "strings level03" que la fonction system est utilisee pour afficher "Exploit me" via un "usr/bin/echo".

Tentative de trouver un moyen de remplacer la chaine de charactere "usr/bin/echo Exploit me" par autre chose...

Je ne trouve pas.

Je me renseigne sur le path hijacking qui permettrait de modifier le path et de faire executer un faux echo code par moi.

ok le programme utilise /usr/bin/env, cet executable fait ce qu'on avait fait dans pipex, c'est a dire que ca cherche dans PATH si un echo est executable en testant tous les chemins, cela permet de ne pas etre oblige de specifier le chemin absolu.

j'utilise cette faille, j'ai juste a creer un dossier nomme /tmp/fake par exemple, a lui mettre un fichier "echo" executable, et lorsque /usr/bin/env ira tester, il executera mon echo, c'est a moi de mettre ce que je veux dans ce binaire.

Je vais tenter de mettre plusieurs commandes pour voir, principalemet en cherchant dans flag03 puisque le programme s'execute avec ses permissions.

Apres plusieurs tentatives de cat ou ls, j'ai compris que je pouvais simplement executer getflag, vu que ca s'execute avec les droits de flag03, pas besoin de me connecter avec lui j'ai directement eu le token pour me connecter a level04 !!!

j'ai fait cette commande, puis j'ai execute le fichier "echo -e '#!/bin/bash\ncd /home/flag/flag03 && getflag' > /tmp/fakebin/echo" avec bien PATH=/tmp/fakebin:/usr/bin...

CA FONCTIONNE !!!
Flag = qi0maab88jeaj46qoumi7maus